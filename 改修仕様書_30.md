# æ”¹ä¿®ä»•æ§˜æ›¸ 30

## ãƒ•ã‚§ãƒ¼ã‚º2.5 - Supabaseç”¨åˆæœŸãƒ‡ãƒ¼ã‚¿æŠ•å…¥ï¼†ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ç”Ÿæˆã‚·ã‚¹ãƒ†ãƒ 

### æ”¹ä¿®ã®ç›®çš„
Supabaseç’°å¢ƒã«æœ€é©åŒ–ã•ã‚ŒãŸåˆæœŸãƒ‡ãƒ¼ã‚¿æŠ•å…¥ã‚·ã‚¹ãƒ†ãƒ ã‚’æ§‹ç¯‰ã—ã€é–‹ç™ºåŠ¹ç‡ã®å‘ä¸Šã¨ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã®å“è³ªã‚’ä¿è¨¼ã—ã¾ã™ã€‚Supabase Authã€RLSï¼ˆRow Level Securityï¼‰ã€ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æ©Ÿèƒ½ã‚’è€ƒæ…®ã—ãŸãƒ‡ãƒ¼ã‚¿ç”Ÿæˆã‚’å®Ÿè£…ã—ã¾ã™ã€‚

### æ”¹ä¿®å†…å®¹

#### 1. Supabaseå¯¾å¿œãƒ‡ãƒ¼ã‚¿ã‚·ãƒ¼ãƒ€ãƒ¼ã‚¯ãƒ©ã‚¹ã®å®Ÿè£…
```typescript
// scripts/seeds/SupabaseSeeder.ts
import { createClient, SupabaseClient } from '@supabase/supabase-js';
import bcrypt from 'bcryptjs';
import { faker } from '@faker-js/faker/locale/ja';
import chalk from 'chalk';
import ora from 'ora';
import { addDays, subMonths } from 'date-fns';

interface SeedConfig {
  environment: 'development' | 'staging' | 'production' | 'test';
  locale: string;
  batchSize: number;
  verbose: boolean;
  specific?: string[];
  force?: boolean;
  quantity?: {
    users?: number;
    products?: number;
    transactions?: number;
    reviews?: number;
  };
}

export class SupabaseSeeder {
  private supabase: SupabaseClient;
  private adminSupabase: SupabaseClient; // Adminæ¨©é™ç”¨
  private config: SeedConfig;
  private statistics: Map<string, number> = new Map();
  private relationships: Map<string, any[]> = new Map();

  constructor(config: SeedConfig) {
    this.config = config;
    faker.locale = config.locale;
    
    // é€šå¸¸ã®ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ
    this.supabase = createClient(
      process.env.NEXT_PUBLIC_SUPABASE_URL!,
      process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!
    );
    
    // ç®¡ç†è€…ç”¨ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆï¼ˆRLSãƒã‚¤ãƒ‘ã‚¹ï¼‰
    this.adminSupabase = createClient(
      process.env.NEXT_PUBLIC_SUPABASE_URL!,
      process.env.SUPABASE_SERVICE_ROLE_KEY!,
      {
        auth: {
          autoRefreshToken: false,
          persistSession: false
        }
      }
    );
  }

  async seed(): Promise<void> {
    const spinner = ora('Initializing Supabase seed process...').start();

    try {
      
      // ç’°å¢ƒãƒã‚§ãƒƒã‚¯
      await this.verifyEnvironment(client);
      
      // ã‚·ãƒ¼ãƒ‰é †åºï¼ˆä¾å­˜é–¢ä¿‚è€ƒæ…®ï¼‰
      const seedOrder = [
        { name: 'users', method: this.seedUsers.bind(this) },
        { name: 'categories', method: this.seedCategories.bind(this) },
        { name: 'products', method: this.seedProducts.bind(this) },
        { name: 'inventory', method: this.seedInventory.bind(this) },
        { name: 'transactions', method: this.seedTransactions.bind(this) },
        { name: 'reviews', method: this.seedReviews.bind(this) },
        { name: 'analytics', method: this.seedAnalytics.bind(this) }
      ];

      for (const seed of seedOrder) {
        if (this.shouldSeed(seed.name)) {
          spinner.text = `Seeding ${seed.name}...`;
          const count = await seed.method(client);
          this.statistics.set(seed.name, count);
          spinner.succeed(`${seed.name}: ${count} records created`);
        }
      }

      spinner.succeed('Supabase seed completed successfully!');
      
      this.printStatistics();
      
    } catch (error) {
      spinner.fail('Supabase seed failed');
      throw error;
    }
  }

  private async seedUsers(): Promise<number> {
    const users = [];
    const quantity = this.config.quantity?.users || this.getDefaultQuantity('users');

    // Supabase AuthçµŒç”±ã§ç®¡ç†è€…ãƒ¦ãƒ¼ã‚¶ãƒ¼ä½œæˆ
    if (this.config.environment !== 'production' || this.config.force) {
      const { data: adminAuth, error: adminError } = await this.adminSupabase.auth.admin.createUser({
        email: 'admin@example.com',
        password: process.env.ADMIN_PASSWORD || 'Admin123!@#',
        email_confirm: true,
        user_metadata: {
          name: 'System Administrator',
          role: 'super_admin'
        }
      });
      
      if (adminAuth && !adminError) {
        // ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ãƒ†ãƒ¼ãƒ–ãƒ«ã«è¿½åŠ æƒ…å ±ã‚’ä¿å­˜
        await this.adminSupabase.from('profiles').insert({
          id: adminAuth.user.id,
          email: 'admin@example.com',
          name: 'System Administrator',
          role: 'super_admin',
          metadata: {
            source: 'seed',
            environment: this.config.environment
          }
        });
        users.push(adminAuth.user);
      }
    }

    // ã‚¹ã‚¿ãƒƒãƒ•ãƒ¦ãƒ¼ã‚¶ãƒ¼ï¼ˆé–‹ç™ºãƒ»ã‚¹ãƒ†ãƒ¼ã‚¸ãƒ³ã‚°ç’°å¢ƒï¼‰
    if (this.config.environment !== 'production') {
      users.push({
        id: 'a0000000-0000-0000-0000-000000000002',
        email: 'staff@example.com',
        password_hash: await bcrypt.hash('Staff123!', 12),
        role: 'staff',
        name: 'Staff Member',
        email_verified: true
      });
    }

    // ãƒ†ã‚¹ãƒˆãƒ¦ãƒ¼ã‚¶ãƒ¼ç”Ÿæˆï¼ˆé–‹ç™ºç’°å¢ƒï¼‰
    if (this.config.environment === 'development') {
      for (let i = 0; i < quantity - 2; i++) {
        const firstName = faker.person.firstName();
        const lastName = faker.person.lastName();
        const user = {
          email: faker.internet.email({ firstName, lastName }).toLowerCase(),
          password_hash: await bcrypt.hash('Password123!', 12),
          role: faker.helpers.arrayElement(['customer', 'customer', 'customer', 'staff']),
          name: `${lastName} ${firstName}`,
          phone: faker.phone.number(),
          avatar_url: faker.image.avatar(),
          addresses: JSON.stringify([
            {
              type: 'primary',
              postal_code: faker.location.zipCode(),
              prefecture: faker.location.state(),
              city: faker.location.city(),
              address_line1: faker.location.streetAddress(),
              address_line2: faker.location.secondaryAddress()
            }
          ]),
          email_verified: faker.datatype.boolean({ probability: 0.8 }),
          two_factor_enabled: faker.datatype.boolean({ probability: 0.3 }),
          metadata: {
            preferences: {
              newsletter: faker.datatype.boolean(),
              notifications: faker.datatype.boolean()
            },
            source: 'seed',
            created_by: 'DataSeeder'
          },
          created_at: faker.date.between({ 
            from: subMonths(new Date(), 12), 
            to: new Date() 
          })
        };
        users.push(user);
      }
    }

    // Supabase Authã‚’ä½¿ç”¨ã—ã¦ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’ä½œæˆ
    const insertedUsers = [];
    for (const userData of users) {
      if (userData.email) {
        const { data: authUser, error } = await this.adminSupabase.auth.admin.createUser({
          email: userData.email,
          password: 'Password123!',
          email_confirm: userData.email_verified || false,
          user_metadata: {
            name: userData.name,
            role: userData.role
          }
        });
        
        if (authUser && !error) {
          // ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‡ãƒ¼ã‚¿ã‚’è¿½åŠ 
          const { data: profile } = await this.adminSupabase
            .from('profiles')
            .insert({
              id: authUser.user.id,
              ...userData,
              password_hash: undefined // Authã§ç®¡ç†ã™ã‚‹ãŸã‚ä¸è¦
            })
            .select()
            .single();
          
          if (profile) insertedUsers.push(profile);
        }
      }
    }

    this.relationships.set('users', insertedUsers);
    return insertedUsers.length;
  }

  private async seedProducts(): Promise<number> {
    const quantity = this.config.quantity?.products || this.getDefaultQuantity('products');
    const categories = this.relationships.get('categories') || [];
    const products = [];

    // ã‚²ãƒ¼ãƒ é–¢é€£å•†å“ã®ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ
    const templates = {
      consoles: [
        { name: 'Nintendo Switch', manufacturer: 'ä»»å¤©å ‚', base_price: 32000 },
        { name: 'PlayStation 5', manufacturer: 'Sony', base_price: 55000 },
        { name: 'Xbox Series X', manufacturer: 'Microsoft', base_price: 50000 },
        { name: 'Steam Deck', manufacturer: 'Valve', base_price: 60000 }
      ],
      games: [
        { name: 'ã‚¼ãƒ«ãƒ€ã®ä¼èª¬', manufacturer: 'ä»»å¤©å ‚', base_price: 7000 },
        { name: 'ãƒã‚±ãƒƒãƒˆãƒ¢ãƒ³ã‚¹ã‚¿ãƒ¼', manufacturer: 'Game Freak', base_price: 6000 },
        { name: 'ãƒ•ã‚¡ã‚¤ãƒŠãƒ«ãƒ•ã‚¡ãƒ³ã‚¿ã‚¸ãƒ¼', manufacturer: 'Square Enix', base_price: 8000 },
        { name: 'ãƒ¢ãƒ³ã‚¹ã‚¿ãƒ¼ãƒãƒ³ã‚¿ãƒ¼', manufacturer: 'Capcom', base_price: 7500 }
      ],
      accessories: [
        { name: 'Pro ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ãƒ¼', manufacturer: 'å„ç¨®', base_price: 7000 },
        { name: 'ãƒ¯ã‚¤ãƒ¤ãƒ¬ã‚¹ãƒ˜ãƒƒãƒ‰ã‚»ãƒƒãƒˆ', manufacturer: 'å„ç¨®', base_price: 10000 },
        { name: 'ã‚­ãƒ£ãƒªãƒ³ã‚°ã‚±ãƒ¼ã‚¹', manufacturer: 'å„ç¨®', base_price: 2000 }
      ]
    };

    for (let i = 0; i < quantity; i++) {
      const category = faker.helpers.arrayElement(Object.keys(templates));
      const template = faker.helpers.arrayElement(templates[category]);
      const condition = faker.helpers.arrayElement(['S', 'A', 'B', 'C', 'D']);
      const conditionMultiplier = { S: 1.0, A: 0.9, B: 0.75, C: 0.6, D: 0.4 }[condition];
      
      const product = {
        sku: this.generateSKU(category, i),
        name: `${template.name} ${faker.commerce.productAdjective()}`,
        description: faker.commerce.productDescription(),
        category_id: categories.find(c => c.name === category)?.id,
        manufacturer: template.manufacturer,
        model_number: faker.string.alphanumeric(8).toUpperCase(),
        barcode: faker.string.numeric(13),
        condition_grade: condition,
        condition_notes: this.generateConditionNotes(condition),
        purchase_price: Math.floor(template.base_price * conditionMultiplier * 0.7),
        selling_price: Math.floor(template.base_price * conditionMultiplier),
        wholesale_price: Math.floor(template.base_price * conditionMultiplier * 0.85),
        images: JSON.stringify([
          faker.image.url(),
          faker.image.url(),
          faker.image.url()
        ]),
        specifications: JSON.stringify({
          weight: faker.number.int({ min: 100, max: 5000 }),
          dimensions: {
            length: faker.number.int({ min: 10, max: 50 }),
            width: faker.number.int({ min: 10, max: 40 }),
            height: faker.number.int({ min: 5, max: 30 })
          },
          warranty_months: faker.helpers.arrayElement([0, 3, 6, 12]),
          origin_country: faker.location.country()
        }),
        tags: JSON.stringify(faker.helpers.arrayElements([
          'popular', 'limited', 'rare', 'vintage', 'new_arrival', 
          'sale', 'recommended', 'exclusive'
        ], { min: 1, max: 3 })),
        status: faker.helpers.weightedArrayElement([
          { weight: 70, value: 'active' },
          { weight: 20, value: 'inactive' },
          { weight: 10, value: 'discontinued' }
        ]),
        created_at: faker.date.between({
          from: subMonths(new Date(), 6),
          to: new Date()
        })
      };
      
      products.push(product);
    }

    // Supabaseã«ãƒãƒƒãƒã‚¤ãƒ³ã‚µãƒ¼ãƒˆ
    const { data: insertedProducts, error } = await this.adminSupabase
      .from('products')
      .insert(products)
      .select();
    
    if (error) {
      console.error('Product insertion error:', error);
      return 0;
    }

    this.relationships.set('products', insertedProducts);
    return insertedProducts.length;
  }

  private async seedTransactions(): Promise<number> {
    const quantity = this.config.quantity?.transactions || this.getDefaultQuantity('transactions');
    const users = this.relationships.get('users') || [];
    const products = this.relationships.get('products') || [];
    const transactions = [];

    for (let i = 0; i < quantity; i++) {
      const transactionDate = faker.date.between({
        from: subMonths(new Date(), 3),
        to: new Date()
      });
      
      const itemCount = faker.number.int({ min: 1, max: 5 });
      const items = [];
      let totalAmount = 0;

      for (let j = 0; j < itemCount; j++) {
        const product = faker.helpers.arrayElement(products);
        const quantity = faker.number.int({ min: 1, max: 3 });
        const price = product.selling_price;
        const subtotal = price * quantity;
        
        items.push({
          product_id: product.id,
          product_name: product.name,
          quantity,
          unit_price: price,
          subtotal,
          discount_amount: faker.number.int({ min: 0, max: subtotal * 0.1 })
        });
        
        totalAmount += subtotal;
      }

      const transaction = {
        transaction_number: `TXN${transactionDate.getFullYear()}${String(i + 1).padStart(8, '0')}`,
        user_id: faker.helpers.arrayElement(users.filter(u => u.role === 'customer'))?.id,
        type: faker.helpers.arrayElement(['purchase', 'sale', 'return', 'exchange']),
        status: faker.helpers.weightedArrayElement([
          { weight: 60, value: 'completed' },
          { weight: 20, value: 'pending' },
          { weight: 10, value: 'processing' },
          { weight: 5, value: 'cancelled' },
          { weight: 5, value: 'refunded' }
        ]),
        items: JSON.stringify(items),
        subtotal_amount: totalAmount,
        tax_amount: Math.floor(totalAmount * 0.1),
        discount_amount: faker.number.int({ min: 0, max: totalAmount * 0.15 }),
        total_amount: Math.floor(totalAmount * 1.1),
        payment_method: faker.helpers.arrayElement(['cash', 'credit_card', 'debit_card', 'bank_transfer', 'qr_payment']),
        payment_status: faker.helpers.arrayElement(['paid', 'pending', 'partial', 'overdue']),
        notes: faker.datatype.boolean({ probability: 0.3 }) ? faker.lorem.sentence() : null,
        metadata: JSON.stringify({
          ip_address: faker.internet.ip(),
          user_agent: faker.internet.userAgent(),
          source: faker.helpers.arrayElement(['web', 'mobile', 'pos', 'api'])
        }),
        created_at: transactionDate
      };
      
      transactions.push(transaction);
    }

    // Supabaseã«ãƒãƒƒãƒã‚¤ãƒ³ã‚µãƒ¼ãƒˆ
    const { data: insertedTransactions, error } = await this.adminSupabase
      .from('transactions')
      .insert(transactions)
      .select();
    
    if (error) {
      console.error('Transaction insertion error:', error);
      return 0;
    }

    this.relationships.set('transactions', insertedTransactions);
    return insertedTransactions.length;
  }

  // Supabaseç”¨ãƒãƒƒãƒã‚¤ãƒ³ã‚µãƒ¼ãƒˆï¼ˆRLSãƒã‚¤ãƒ‘ã‚¹ï¼‰
  private async supabaseBatchInsert(
    table: string,
    data: any[]
  ): Promise<any[]> {
    if (data.length === 0) return [];

    const chunks = this.chunkArray(data, this.config.batchSize);
    const inserted = [];

    for (const chunk of chunks) {
      const { data: result, error } = await this.adminSupabase
        .from(table)
        .insert(chunk)
        .select();
      
      if (error) {
        console.error(`Error inserting into ${table}:`, error);
        continue;
      }
      
      if (result) {
        inserted.push(...result);
      }
    }

    return inserted;
  }

  private generateSKU(category: string, index: number): string {
    const prefix = category.substring(0, 3).toUpperCase();
    const timestamp = Date.now().toString(36).toUpperCase();
    const sequence = String(index + 1).padStart(4, '0');
    return `${prefix}-${timestamp}-${sequence}`;
  }

  private generateConditionNotes(grade: string): string {
    const notes = {
      S: 'æ–°å“ãƒ»æœªé–‹å°å“',
      A: 'ç¾å“ãƒ»ã»ã¼æ–°å“åŒæ§˜',
      B: 'è‰¯å“ãƒ»å¤šå°‘ã®ä½¿ç”¨æ„Ÿã‚ã‚Š',
      C: 'å¯ãƒ»ä½¿ç”¨æ„Ÿã‚ã‚Šã€å‹•ä½œç¢ºèªæ¸ˆã¿',
      D: 'ã‚¸ãƒ£ãƒ³ã‚¯ãƒ»éƒ¨å“å–ã‚Šç”¨'
    };
    return notes[grade] || '';
  }

  private getDefaultQuantity(type: string): number {
    const defaults = {
      development: { users: 100, products: 200, transactions: 500, reviews: 300 },
      staging: { users: 20, products: 50, transactions: 100, reviews: 50 },
      production: { users: 1, products: 0, transactions: 0, reviews: 0 },
      test: { users: 10, products: 20, transactions: 30, reviews: 15 }
    };
    return defaults[this.config.environment]?.[type] || 0;
  }

  private shouldSeed(type: string): boolean {
    if (this.config.specific && this.config.specific.length > 0) {
      return this.config.specific.includes(type);
    }
    return this.getDefaultQuantity(type) > 0;
  }

  private chunkArray<T>(array: T[], size: number): T[][] {
    const chunks: T[][] = [];
    for (let i = 0; i < array.length; i += size) {
      chunks.push(array.slice(i, i + size));
    }
    return chunks;
  }

  private async verifyEnvironment(): Promise<void> {
    if (this.config.environment === 'production' && !this.config.force) {
      const { count } = await this.adminSupabase
        .from('profiles')
        .select('*', { count: 'exact', head: true });
      
      if (count && count > 0) {
        throw new Error('Production database already contains data. Use --force to override.');
      }
    }
  }

  private printStatistics(): void {
    console.log(chalk.cyan('\nğŸ“Š Seed Statistics:'));
    console.log(chalk.gray('â”€'.repeat(40)));
    
    let total = 0;
    this.statistics.forEach((count, table) => {
      console.log(chalk.green(`âœ“ ${table}:`), chalk.yellow(count.toLocaleString()), 'records');
      total += count;
    });
    
    console.log(chalk.gray('â”€'.repeat(40)));
    console.log(chalk.blue('Total:'), chalk.yellow(total.toLocaleString()), 'records');
  }
}
```

#### 2. ç’°å¢ƒåˆ¥è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«
```typescript
// scripts/seeds/config.ts
export const seedConfigs = {
  development: {
    locale: 'ja',
    batchSize: 100,
    verbose: true,
    quantity: {
      users: 100,
      products: 200,
      transactions: 500,
      reviews: 300,
      inventory_movements: 1000,
      analytics_events: 5000
    },
    features: {
      generateFakeEmails: true,
      useRealImages: false,
      generateRelationships: true,
      seedAnalytics: true,
      seedTestAccounts: true
    }
  },
  staging: {
    locale: 'ja',
    batchSize: 50,
    verbose: false,
    quantity: {
      users: 20,
      products: 50,
      transactions: 100,
      reviews: 50,
      inventory_movements: 200,
      analytics_events: 1000
    },
    features: {
      generateFakeEmails: false,
      useRealImages: false,
      generateRelationships: true,
      seedAnalytics: true,
      seedTestAccounts: false
    }
  },
  production: {
    locale: 'ja',
    batchSize: 10,
    verbose: false,
    quantity: {
      users: 1, // Admin only
      products: 0,
      transactions: 0,
      reviews: 0,
      inventory_movements: 0,
      analytics_events: 0
    },
    features: {
      generateFakeEmails: false,
      useRealImages: false,
      generateRelationships: false,
      seedAnalytics: false,
      seedTestAccounts: false
    }
  },
  test: {
    locale: 'ja',
    batchSize: 10,
    verbose: false,
    quantity: {
      users: 10,
      products: 20,
      transactions: 30,
      reviews: 15,
      inventory_movements: 50,
      analytics_events: 100
    },
    features: {
      generateFakeEmails: true,
      useRealImages: false,
      generateRelationships: true,
      seedAnalytics: false,
      seedTestAccounts: true
    }
  }
};
```

#### 3. CLIã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹
```typescript
// scripts/seeds/cli.ts
import { Command } from 'commander';
import { SupabaseSeeder } from './SupabaseSeeder';
import { seedConfigs } from './config';
import chalk from 'chalk';
import inquirer from 'inquirer';
import dotenv from 'dotenv';

dotenv.config();

const program = new Command();

program
  .name('seed')
  .description('Database seeding utility')
  .version('1.0.0');

program
  .command('run')
  .description('Run database seeders')
  .option('-e, --env <environment>', 'Target environment', 'development')
  .option('-s, --specific <tables...>', 'Seed specific tables only')
  .option('-q, --quantity <type:count...>', 'Override quantities')
  .option('-f, --force', 'Force seed in production')
  .option('-v, --verbose', 'Verbose output')
  .option('--dry-run', 'Show what would be seeded without executing')
  .action(async (options) => {
    try {
      const config = { ...seedConfigs[options.env], ...options };
      
      if (options.env === 'production' && !options.force) {
        const { confirm } = await inquirer.prompt([{
          type: 'confirm',
          name: 'confirm',
          message: chalk.red('âš ï¸  You are about to seed PRODUCTION database. Are you sure?'),
          default: false
        }]);
        
        if (!confirm) {
          console.log(chalk.yellow('Seed cancelled'));
          process.exit(0);
        }
      }

      const seeder = new SupabaseSeeder(config);
      
      if (options.dryRun) {
        console.log(chalk.blue('DRY RUN - No data will be inserted'));
        seeder.dryRun();
      } else {
        await seeder.seed();
      }
      
      // Supabaseã¯è‡ªå‹•çš„ã«ã‚³ãƒã‚¯ã‚·ãƒ§ãƒ³ã‚’ç®¡ç†
    } catch (error) {
      console.error(chalk.red('Error:'), error.message);
      process.exit(1);
    }
  });

program
  .command('clean')
  .description('Clean all seeded data')
  .option('-e, --env <environment>', 'Target environment', 'development')
  .option('-t, --tables <tables...>', 'Clean specific tables')
  .action(async (options) => {
    // ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—å®Ÿè£…
  });

program.parse();
```

#### 4. ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ†ã‚¹ãƒˆç”¨å¤§é‡ãƒ‡ãƒ¼ã‚¿ç”Ÿæˆ
```typescript
// scripts/seeds/performance.ts
export class PerformanceDataGenerator {
  async generateBulkData(config: {
    users: number;
    products: number;
    transactions: number;
    concurrency: number;
  }): Promise<void> {
    console.log(chalk.blue('Generating performance test data...'));
    
    const workers = [];
    const chunkSize = Math.ceil(config.users / config.concurrency);
    
    for (let i = 0; i < config.concurrency; i++) {
      workers.push(this.generateWorker({
        offset: i * chunkSize,
        limit: chunkSize,
        type: 'users'
      }));
    }
    
    await Promise.all(workers);
    console.log(chalk.green('Performance test data generated'));
  }
}
```

#### 5. NPMã‚¹ã‚¯ãƒªãƒ—ãƒˆã¨Dockerã‚µãƒãƒ¼ãƒˆ
```json
{
  "scripts": {
    "db:seed": "tsx scripts/seeds/cli.ts run",
    "db:seed:dev": "tsx scripts/seeds/cli.ts run -e development",
    "db:seed:staging": "tsx scripts/seeds/cli.ts run -e staging",
    "db:seed:prod": "tsx scripts/seeds/cli.ts run -e production --force",
    "db:seed:test": "tsx scripts/seeds/cli.ts run -e test",
    "db:seed:specific": "tsx scripts/seeds/cli.ts run -s",
    "db:seed:perf": "tsx scripts/seeds/performance.ts",
    "db:clean": "tsx scripts/seeds/cli.ts clean",
    "db:reset-and-seed": "npm run db:reset && npm run db:migrate && npm run db:seed"
  }
}
```

### å½±éŸ¿ç¯„å›²
- scripts/seeds/ï¼ˆæ–°è¦ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹é€ ï¼‰
- scripts/seeds/DataSeeder.tsï¼ˆãƒ¡ã‚¤ãƒ³ã‚¯ãƒ©ã‚¹ï¼‰
- scripts/seeds/config.tsï¼ˆç’°å¢ƒè¨­å®šï¼‰
- scripts/seeds/cli.tsï¼ˆCLIãƒ„ãƒ¼ãƒ«ï¼‰
- scripts/seeds/generators/ï¼ˆãƒ‡ãƒ¼ã‚¿ã‚¸ã‚§ãƒãƒ¬ãƒ¼ã‚¿ï¼‰
- scripts/seeds/fixtures/ï¼ˆå›ºå®šãƒ‡ãƒ¼ã‚¿ï¼‰
- package.jsonï¼ˆã‚¹ã‚¯ãƒªãƒ—ãƒˆè¿½åŠ ï¼‰
- docker-compose.ymlï¼ˆé–‹ç™ºç’°å¢ƒçµ±åˆï¼‰

### æ‰€è¦æ™‚é–“
8-10æ™‚é–“ï¼ˆå®Ÿè£…ãƒ»ãƒ†ã‚¹ãƒˆãƒ»ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆä½œæˆå«ã‚€ï¼‰

### æ¤œè¨¼é …ç›®
- [ ] å…¨ç’°å¢ƒã§é©åˆ‡ãªãƒ‡ãƒ¼ã‚¿ãŒç”Ÿæˆã•ã‚Œã‚‹ã“ã¨
- [ ] ãƒ‡ãƒ¼ã‚¿é–“ã®æ•´åˆæ€§ãŒä¿ãŸã‚Œã‚‹ã“ã¨
- [ ] é‡è¤‡å®Ÿè¡Œæ™‚ã®å†ªç­‰æ€§ãŒç¢ºä¿ã•ã‚Œã‚‹ã“ã¨
- [ ] å¤§é‡ãƒ‡ãƒ¼ã‚¿ç”Ÿæˆæ™‚ã®ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡ãŒé©åˆ‡ã§ã‚ã‚‹ã“ã¨
- [ ] ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³å‡¦ç†ãŒæ­£å¸¸ã«å‹•ä½œã™ã‚‹ã“ã¨
- [ ] ã‚¨ãƒ©ãƒ¼æ™‚ã®ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯ãŒç¢ºå®Ÿã«å®Ÿè¡Œã•ã‚Œã‚‹ã“ã¨
- [ ] æœ¬ç•ªç’°å¢ƒã§ã®å®‰å…¨æ€§ãƒã‚§ãƒƒã‚¯ãŒæ©Ÿèƒ½ã™ã‚‹ã“ã¨
- [ ] ãƒãƒƒãƒå‡¦ç†ã®ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãŒè¦ä»¶ã‚’æº€ãŸã™ã“ã¨
- [ ] ç”Ÿæˆãƒ‡ãƒ¼ã‚¿ãŒãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯ã«æº–æ‹ ã—ã¦ã„ã‚‹ã“ã¨
- [ ] CLIãƒ„ãƒ¼ãƒ«ã®UXãŒç›´æ„Ÿçš„ã§ã‚ã‚‹ã“ã¨

### æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—
æ”¹ä¿®ä»•æ§˜æ›¸_31: localStorageãƒ‡ãƒ¼ã‚¿ç§»è¡Œã¨ãƒ‡ãƒ¼ã‚¿åŒæœŸã‚·ã‚¹ãƒ†ãƒ 