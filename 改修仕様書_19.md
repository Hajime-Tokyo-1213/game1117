# 改修仕様書 19

## フェーズ1.19 - AuthContext JWT対応

### 改修の目的
AuthContextでJWT認証を使用するように更新する

### 改修内容

#### 1. AuthContext.jsxの大幅更新
```javascript
// src/contexts/AuthContext.jsx
import Cookies from 'js-cookie';

const AuthContext = createContext();

export const AuthProvider = ({ children }) => {
  const [user, setUser] = useState(null);
  const [loading, setLoading] = useState(true);
  
  const login = async (email, password) => {
    const response = await fetch('/api/auth/login', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ email, password })
    });
    
    if (response.ok) {
      const { token, user } = await response.json();
      Cookies.set('authToken', token, { httpOnly: true, secure: true });
      setUser(user);
      return user;
    }
    
    throw new Error('認証に失敗しました');
  };
  
  // logout, verifyToken等の実装
}
```

#### 2. トークンベース認証への移行
- Cookieベースのトークン保存
- 自動トークン検証
- 自動ログアウト機能

#### 3. 認証状態の管理
- ローディング状態の管理
- 認証エラーの処理

### 影響範囲
- `src/contexts/AuthContext.jsx`

### 所要時間
4-5時間

### 検証項目
- JWT認証が正常動作すること
- トークンの自動検証が動作すること
- セキュアなトークン保存が実装されていること

### 次のステップ
改修仕様書_20: PrivateRoute認証強化