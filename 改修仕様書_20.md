# 改修仕様書 20

## フェーズ1.20 - PrivateRoute認証強化

### 改修の目的
PrivateRouteコンポーネントでJWT認証を使用し、認証をより強化する

### 改修内容

#### 1. PrivateRoute.jsxの更新
```javascript
// src/components/PrivateRoute.jsx
import { useAuth } from '../contexts/AuthContext';
import { Navigate } from 'react-router-dom';

const PrivateRoute = ({ children, requiredRole = null }) => {
  const { user, loading } = useAuth();
  
  if (loading) {
    return <div>認証確認中...</div>;
  }
  
  if (!user) {
    return <Navigate to="/login" replace />;
  }
  
  if (requiredRole && user.role !== requiredRole) {
    return <Navigate to="/unauthorized" replace />;
  }
  
  return children;
};
```

#### 2. 役割ベースのアクセス制御
- 管理者専用ルート
- スタッフ専用ルート
- カスタマー専用ルート

#### 3. 認証エラー処理の改善
- 未認証時の適切なリダイレクト
- 権限不足時の専用ページ

### 影響範囲
- `src/components/PrivateRoute.jsx`

### 所要時間
2-3時間

### 検証項目
- 認証が必要なルートへの適切な保護
- 役割ベースのアクセス制御が動作すること
- 認証失敗時の適切なリダイレクト

### 次のステップ
改修仕様書_21: 共通バリデーションライブラリ作成