# 改修仕様書 21

## フェーズ1.21 - 共通バリデーションライブラリ作成

### 改修の目的
入力値検証を統一し、XSS対策を含む包括的なバリデーション機能を提供

### 改修内容

#### 1. バリデーションライブラリの作成
```javascript
// src/utils/validation.js
import DOMPurify from 'dompurify';

export const validators = {
  email: (value) => {
    const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
    return emailRegex.test(value);
  },
  
  phone: (value) => {
    const phoneRegex = /^[0-9-+\s()]+$/;
    return phoneRegex.test(value) && value.replace(/\D/g, '').length >= 10;
  },
  
  postalCode: (value) => {
    const postalRegex = /^\d{3}-\d{4}$/;
    return postalRegex.test(value);
  },
  
  required: (value) => {
    return value !== null && value !== undefined && value.toString().trim() !== '';
  }
};

export const sanitize = (input) => {
  return DOMPurify.sanitize(input);
};

export const validateAndSanitize = (value, validationType) => {
  const sanitized = sanitize(value);
  const isValid = validators[validationType] ? validators[validationType](sanitized) : true;
  
  return { value: sanitized, isValid, error: isValid ? null : `Invalid ${validationType}` };
};
```

#### 2. DOMPurifyライブラリの導入
```json
{
  "dependencies": {
    "dompurify": "^3.0.0"
  }
}
```

### 影響範囲
- 新規: `src/utils/validation.js`
- `package.json`

### 所要時間
2-3時間

### 検証項目
- バリデーション関数が正確に動作すること
- XSSサニタイゼーションが正常に機能すること
- パフォーマンスが許容範囲内であること

### 次のステップ
改修仕様書_22: Registerコンポーネントバリデーション統合